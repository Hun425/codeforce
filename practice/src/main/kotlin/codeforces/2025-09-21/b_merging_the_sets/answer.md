# B. Merging the Sets — 풀이 해설 (Kotlin)

## 문제 요약

* `n`개의 집합 `S1..Sn`이 주어지고, 각 집합은 1..m 범위의 원소를 가진다.
* 이 중 일부 집합(0개\~n개)을 선택해 합집합이 1..m을 **모두 덮도록** 만들어야 한다.
* 그렇게 덮는 선택 방법이 **3가지 이상(≥3)** 있는지 판정.
* 있으면 `YES`, 아니면 `NO` 출력.

## 핵심 아이디어

1. **커버 불가능 빠른 거절**: 어떤 원소가 한 번도 등장하지 않으면 어떤 선택으로도 덮을 수 없음 → NO.
2. **유일 커버(필수 집합) 강제 선택**: 아직 덮이지 않은 원소 x가 오직 한 집합에만 등장한다면 그 집합은 반드시 선택해야 한다. 그 집합을 선택하고 덮이는 모든 원소를 제거, 반복.
3. **코어(core) 상태**: 강제 선택 반복 후에도 덮이지 않은 원소가 남으면, 모든 남은 원소는 최소 2개 집합 이상에서 등장함(유일 커버 없음). 이때는 선택의 가지가 생겨 경우의 수가 3 이상이 됨 → YES.
4. **완전히 덮였을 경우**: 강제 선택만으로 이미 모든 원소가 덮이면, 나머지 집합은 선택 여부가 자유로운 옵션 집합이 됨. 옵션 집합의 수 R이라 하면 가능한 선택 방법 수 = 2^R.

  * R ≥ 2 → 경우의 수 ≥ 4 ≥ 3 → YES
  * R ≤ 1 → 경우의 수 ≤ 2 → NO

## 정당성 (왜 맞는가)

* 유일 커버 집합은 고르지 않으면 해당 원소를 덮을 방법이 없어 반드시 선택해야 한다.
* 반복 제거 후 코어가 남는다는 것은 각 원소가 최소 두 집합 이상에 존재한다는 뜻 → 선택의 자유가 생기며 분기 수 ≥ 3.
* 코어가 비어 있고 옵션 집합이 R개라면, 독립적으로 넣을지 뺄지 결정할 수 있으므로 경우의 수 = 2^R.

## 알고리즘 단계

1. 각 원소별로 어떤 집합에 포함되는지 역인덱스 리스트 구성.
2. 등장하지 않은 원소가 있으면 NO.
3. 큐를 이용해 유일 커버 원소를 찾고, 그 집합을 선택 → 덮이는 원소 제거, 큐 갱신.
4. 반복 종료 후 덮이지 않은 원소가 남아 있으면 YES.
5. 모두 덮였다면, 남은 집합 수 R 계산 → R ≥ 2면 YES, 아니면 NO.

## 복잡도

* 역인덱스 생성: O(L)
* 유일 커버 탐색: 각 (원소, 집합) 관계를 한 번씩만 처리 → O(L)
* 전체: O(L), L ≤ 2×10^5 로 충분히 빠름.

## 예시로 검증

### 예제 1

```
3 2
2 1 2
1 1
1 2
```

* 모든 원소 {1,2} 등장.
* 유일 커버 없음 → 코어 상태, 선택 방법 5개 (≥3) → YES.

### 예제 2

```
4 10
3 1 2 3
2 4 5
1 6
4 7 8 9 10
```

* 모든 원소는 반드시 모든 집합을 다 선택해야만 덮임 → 경우의 수 1 → NO.

### 예제 3

```
2 5
4 1 2 3 4
4 1 2 3 4
```

* 원소 5가 등장하지 않음 → 덮기 불가 → NO.

### 예제 4

```
5 5
5 1 2 3 4 5
5 1 2 3 4 5
5 1 2 3 4 5
5 1 2 3 4 5
5 1 2 3 4 5
```

* 어떤 집합을 골라도 모든 원소가 항상 덮임 → 경우의 수 2^5-1=31 ≥ 3 → YES.
